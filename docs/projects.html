<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Within Family Consortium - Current projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="The Within Family Consortium - Current projects">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@nm_davies">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Within Family Consortium</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cohorts.html"> 
<span class="menu-text">Cohorts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" aria-current="page"> 
<span class="menu-text">Current projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./proposals.html"> 
<span class="menu-text">Project proposals</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./outputs.html"> 
<span class="menu-text">Key outputs</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-1-sibling-gwas" id="toc-project-1-sibling-gwas" class="nav-link active" data-scroll-target="#project-1-sibling-gwas">Project 1: Sibling GWAS</a></li>
  <li><a href="#project-2-mz-gwas-of-variance" id="toc-project-2-mz-gwas-of-variance" class="nav-link" data-scroll-target="#project-2-mz-gwas-of-variance">Project 2: MZ GWAS of variance</a></li>
  <li><a href="#project-3-trio-gwas" id="toc-project-3-trio-gwas" class="nav-link" data-scroll-target="#project-3-trio-gwas">Project 3: Trio GWAS</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Current projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-1-sibling-gwas" class="level2">
<h2 class="anchored" data-anchor-id="project-1-sibling-gwas">Project 1: Sibling GWAS</h2>
<p>Leads: Laurence Howe, Ben Brumpton, Gib Hemani, Neil Davies</p>
<p>Published <a href="https://www.nature.com/articles/s41588-022-01062-7">Howe et al., 2022</a>:</p>
<ol type="1">
<li>Howe, L. J. et al.&nbsp;Within-sibship genome-wide association analyses decrease bias in estimates of direct genetic effects. Nat Genet 54, 581–592 (2022).</li>
</ol>
<p>There is increasing evidence that genetic effects on social phenotypes are substantially attenuated after controlling for family fixed effects in samples of siblings. For example, <a href="https://www.nature.com/articles/s41588-018-0147-3">Lee et al., 2018</a> found that the effects of the genome-wide significant SNPs for years of education attenuated by around one half. Consistent with this, <a href="https://science.sciencemag.org/content/359/6374/424">Kong et al (2018)</a> found substantial evidence that non-inherited genetic variants were associated with outcomes in offspring. These findings suggest that genetic effects estimated in GWAS for some (particularly social) phenotypes may be biased. In this project, we will conduct GWA on samples of siblings using a within family model (i.e.&nbsp;including a family fixed effect). This analysis will be conducted across a broad range of available phenotypes (e.g.&nbsp;education, cognitive performance, BMI, height, CRP, etc) to investigate the prevalence of “within family” bias in established GWAS of unrelated individuals. This project will focus on a sibling design, but there are plans to expand future projects to include mother-father-offspring trio designs.</p>
<p>Research question: Do total, between and within family SNP-phenotype associations differ?</p>
<p>We are conducting GWAS of 25 phenotypes using data from studies with siblings and relevant phenotypes. A full description of the analysis can be found in the <a href="https://docs.google.com/document/d/1A9HbwdVEnSul7eSeTdYfLtH1rkjTv5VMYVBs0wfZnxQ/edit?usp=sharing">statistical analysis plan</a>. The end of the SAP lists the studies that are contributing to the analysis, study eligibility requirements and the phenotypes that are currently included in the study.</p>
<p><strong>Code</strong></p>
<p>The analysis was run independently by analysts for each study. Laurence Howe wrote an automated pipeline that is available on his <a href="https://github.com/LaurenceHowe/SiblingGWAS">GitHub page</a>. This automated most of the process of running the analysis, creating the study summary data and packaging the summary associations (SNP-phenotype associations) up for upload to University of Bristol servers. We meta-analyzed the summary data across the studies, and made summary data publicly available.</p>
</section>
<section id="project-2-mz-gwas-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="project-2-mz-gwas-of-variance">Project 2: MZ GWAS of variance</h2>
<p>Leads: Elham Assray, Teemu Palviainen, Patrica Monroe, Neil Davies, Gibran Hemani, Jaakko Kaprio</p>
<p>The majority of genome-wide association studies (GWAS) to date have focused on identifying genetic markers associated with phenotype means. Contrastingly, much less is understood about genetic markers which influence phenotypic variation (variance quantitative trait loci; vQTL). The association of such markers with phenotypic variation may reflect interactions with environmental factors, as is thought to be the case for the adiposity influencing variant near/in FTO, or may capture biological mechanisms of an allele leading directly to higher variability. Therefore, identification of vQTL could improve understanding of underlying biology as well as the interplay between genetics and the environment.</p>
<p>Previous research into vQTLs has largely focused on obesity-related traits and predominantly used non-family based methods; for example, two recent studies (Young, Wauthier et al.&nbsp;2018, Wang, Zhang et al.&nbsp;2019) using UK Biobank data. An orthogonal approach to identify vQTL is to use a family-based method where we evaluate if there are genetic effects on phenotypic differences between monozygotic (MZ) twins. MZ twins share the same genotype at the vast majority of the genome but will often have discernible phenotypic differences. This MZ twin approach for identifying vQTL has been used previously for lipids on a sample of around 2,000 twin-pairs (Surakka, Whitfield et al.&nbsp;2012) and in emotional symptoms in a sample of around 1,000 twin-pairs (Keers, Coleman et al.&nbsp;2016). In this more recent study, the authors showed that a polygenic score created using the results of the GWAS moderated the effects of parenting and treatment response in two further samples.</p>
<p>We propose to extend previous work with a larger sample size and with the inclusion of additional phenotypes. This will involve a collaborative meta-analysis GWAS of associations between genetic variation and phenotypic differences between monozygotic twins for a variety of physical and psychological phenotypes (e.g.&nbsp;height, body mass index, lipids, depression and anxiety and educational attainment). A full description of the analysis can be found in the <a href="https://docs.google.com/document/d/1xyl9-z5SFDThLKy8U4s6YajjeyhZ7nJ-/edit?usp=sharing&amp;ouid=109894450388197632569&amp;rtpof=true&amp;sd=true">statistical analysis plan</a>.</p>
<p><strong>Code</strong> Github repository containing an example pipeline with relevant scripts can be found <a href="https://github.com/LaurenceHowe/MZTwins-vQTL">here</a>. As with the sibling GWAS, this automates most of the process of running the analysis, creating the study summary data and packages summary associations (SNP-phenotype associations) up for upload to KCL/University of Helsinki servers. Again, we will meta-analyze the summary data across the studies, and make summary data publicly available.</p>
<p><strong>Pre-print</strong> We have finished a first draft of this paper and uploaded to ResearchSquare, you can find the full paper <a href="https://www.researchsquare.com/article/rs-4333635/v1">here</a>.</p>
</section>
<section id="project-3-trio-gwas" class="level2">
<h2 class="anchored" data-anchor-id="project-3-trio-gwas">Project 3: Trio GWAS</h2>
<p>Leads: Isabella Badini, Alexandra Havdahl, David Bann, Gib Hemani, Neil Davies</p>
<p>Increasing evidence suggests that population-based GWAS estimates for some phenotypes capture associations relating to population stratification, assortative mating and indirect genetic effects. For example, <a href="https://www.nature.com/articles/s41588-018-0147-3">Lee et al., 2018</a> found that the effect estimates of genome-wide significant SNPs for years of education, discovered in a population-based GWAS of unrelated individuals, attenuated by around one-half in within-sibship models which control for population stratification, assortative mating and parental indirect genetic effects. Consistent with this, <a href="https://www.science.org/doi/10.1126/science.aan6877">Kong and colleagues (2018)</a> found evidence for indirect parental genetic effects in 21,637 individuals with genotyped parents, showing that non-inherited genetic variants related to parental education influenced offspring outcomes in the DeCODE study. <a href="https://www.nature.com/articles/s41588-022-01062-7">Howe et al., 2022</a> compared population-based GWAS estimates with within-sibship GWAS estimates for 25 phenotypes in a sample of 178,086 siblings. They found that the within-sibship estimates were substantially attenuated for some phenotypes, particularly socioeconomic phenotypes such as educational attainment and age at first birth. These findings illustrate the importance of within-family models for decomposing population-based GWAS estimates into the different sources of SNP-phenotype associations, such as direct and indirect genetic effects.</p>
<p>GWAS using parent-offspring data is particularly useful for disentangling the different sources of genetic association. In trio and duo studies, we can directly control for parental genotype, which allows us to both control for and estimate the indirect genetic effects of parents. We will conduct a consortium-based parent-offspring GWAS to investigate differences between population-based and within-family GWAS estimates. We will also compare parent-offspring GWAS estimates with the within-sibship GWAS estimates.</p>
<p><strong>Research question</strong>: To what extent do differences between population and within-family SNP-phenotype associations differ, and how do familial and demographic factors affect downstream analysis of GWAS summary data?</p>
<p>We are conducting GWAS of 25 phenotypes using data from studies with siblings and relevant phenotypes. A full description of the analysis can be found in the <a href="https://docs.google.com/document/d/1Jsf1r3YFPZjuKyYnXh6ekP03AS6_mm34usEREeHuC9Y/edit?usp=sharing">statistical analysis plan</a>. The end of the SAP lists the studies that are contributing to the analysis, study eligibility requirements and the phenotypes that are currently included in the study.</p>
<p><strong>Code</strong></p>
<p>The analysis is being run independently by analysts for each study. Isabella Badini has written an automated pipeline that is available on her <a href="https://github.com/isabellabadini/TrioGWAS">GitHub page</a>. This automates most of the process of running the analysis, creating the study summary data and packages summary associations (SNP-phenotype associations) up for upload to University College London. We will meta-analyze the summary data across the studies, and make summary data publicly available.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<hr style="width: 100%;">

<table style="width: 100%;">
<tbody><tr>
<td style="text-align: left; vertical-align: top;">
<p>
Contact Information:<br> <strong>Email:</strong> <a href="mailti:neil.m.davies@ucl.ac.uk">neil.m.davies@ucl.ac.uk</a>
</p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; padding: 10px;">
<a href="https://www.bristol.ac.uk/ieu/" target="_blank"> <img src="assets/mrc-ieu-logo.png" width="180"> </a><br>
</td>
<td style="text-align: left; vertical-align: top; padding: 10px;">
<a href="https://www.bristol.ac.uk/" target="_blank"> <img src="assets/bristol.png" width="150"> </a>
</td>
<td style="text-align: left; vertical-align: top; padding: 10px;">
<a href="https://www.ucl.ac.uk/" target="_blank"> <img src="assets/ucl.png" width="150"> </a>
</td>
</tr>
</tbody></table>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>

</div>




</body></html>